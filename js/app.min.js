var fireworkButton,beerButton,cavaButton,wineButton,messageInput,messageButton,loadCamButton,cancelCamButton,cameraSelection,webcamElement,canvasElement,refreshPhotowall,photoWall,webcamOverlay,ip,player,sleepTime;const listenToLoadCam=function(){loadCamButton.addEventListener("click",function(){webcamOverlay.classList.remove("c-cam-overlay-hide"),startWebcam()})},loadIp=async function(){let e=await fetch("https://www.cloudflare.com/cdn-cgi/trace",{mode:"cors"}),t=(await e.text()).split("\n").filter(e=>e.startsWith("ip")).join("\n");ip=t.split("=")[1]};String.prototype.isEmpty=function(){return 0===this.length||!this.trim()};const listenToButtons=function(){messageButton.addEventListener("click",listenToSubmit)},listenToSubmit=function(){if(console.log("SUBMIT CLICKED"),sleepTimeCET=new Date((new Date).getTime()+6e4),sleepTimeMillies=(new Date).getTime()+6e4,Cookies.set("submit","digeriedoo",{expires:sleepTimeCET}),Cookies.set("submit_timeout",sleepTimeMillies,{expires:sleepTimeCET}),messageButton.classList.add("c-button-off"),messageInput.value.length<=60&&!messageInput.value.isEmpty()){var e={ip:ip,dialog:messageInput.value};postMessage(e),messageInput.value="",messageInput.classList.remove("c-input-has-error")}else messageInput.classList.add("c-input-has-error")},checkCookies=function(){null!=Cookies.get("submit")?(messageButton.classList.add("c-button-off"),messageButton.removeEventListener("click",listenToSubmit),addTimerMessageButton()):(messageButton.classList.remove("c-button-off"),messageButton.addEventListener("click",listenToSubmit)),null!=Cookies.get("firework")?(fireworkButton.classList.add("c-button-off"),fireworkButton.removeEventListener("click",sendFireworks)):(fireworkButton.classList.remove("c-button-off"),fireworkButton.addEventListener("click",sendFireworks))},addTimerMessageButton=function(){var e=setInterval(function(){var t=(new Date).getTime(),n=sleepTimeMillies-t,o=Math.floor(n%6e4/1e3);messageButton.innerHTML=o,n<0&&(clearInterval(e),messageButton.innerHTML="SEND")},1e3)},cookieTest=function(){var e=new Date((new Date).getTime()+6e4);Cookies.set("firework","false",{expires:e})},postMessage=function(e){fetch("https://kraknye2021.azurewebsites.net/api/krak/nye/live/messages",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>console.log("Success:",JSON.stringify(e))).catch(e=>console.error("Error:",e))},listenToIcons=function(){fireworkButton.addEventListener("click",sendFireworks),beerButton.addEventListener("click",sendBeer),cavaButton.addEventListener("click",sendCava),wineButton.addEventListener("click",sendWine)},sendBeer=async()=>{await fetch("https://kraknye2021.azurewebsites.net/api/krak/nye/live/icons/beer").then(e=>e.json()).catch(e=>console.error("An error occurd",e))},sendCava=async()=>{await fetch("https://kraknye2021.azurewebsites.net/api/krak/nye/live/icons/cava").then(e=>e.json()).catch(e=>console.error("An error occurd",e))},sendWine=async()=>{await fetch("https://kraknye2021.azurewebsites.net/api/krak/nye/live/icons/wine").then(e=>e.json()).catch(e=>console.error("An error occurd",e))},sendFireworks=async()=>{var e=new Date((new Date).getTime()+6e4);Cookies.set("firework","digeriedoo",{expires:e}),fireworkButton.classList.add("c-button-off");await fetch("https://kraknye2021.azurewebsites.net/api/krak/nye/live/icons/firework").then(e=>e.json()).catch(e=>console.error("An error occurd",e))},listenToRefresh=function(){refreshPhotowall.addEventListener("click",getImages)},getImages=async()=>{var e;e=await fetch("https://kraknye2021photobooth.azurewebsites.net/api/krak/nye/live/photbooth/photos").then(e=>e.json()).catch(e=>console.error("An error occurd",e)),fillImages(e)},fillImages=function(e){var t="";e.forEach(e=>{t+=` <li class="c-pb_wall--li">\n                            <img src="${e}" alt="foto" class="c-pb_wall--img">\n                        </li>`}),t+="<li></li>",photoWall.innerHTML=t},getDOMElements=function(){fireworkButton=document.querySelector(".js-firework"),beerButton=document.querySelector(".js-beer"),cavaButton=document.querySelector(".js-cava"),wineButton=document.querySelector(".js-wine"),messageInput=document.querySelector(".js-message-input"),messageButton=document.querySelector(".js-message-button"),loadCamButton=document.querySelector(".js-load-cam"),photoWall=document.querySelector(".js-photo-wall"),webcamOverlay=document.querySelector(".js-overlay"),refreshPhotowall=document.querySelector(".js-refresh-pw")},loadStream=function(){player=new Twitch.Player("js-stream-content",{height:"100%",width:"100%",channel:"JHkrak"})},checkIE=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/")};document.addEventListener("DOMContentLoaded",function(){console.log("Script loaded!"),sleepTimeMillies=Cookies.get("submit_timeout"),fireworkButton=document.querySelector(".js-firework"),beerButton=document.querySelector(".js-beer"),cavaButton=document.querySelector(".js-cava"),wineButton=document.querySelector(".js-wine"),messageInput=document.querySelector(".js-message-input"),messageButton=document.querySelector(".js-message-button"),loadCamButton=document.querySelector(".js-load-cam"),photoWall=document.querySelector(".js-photo-wall"),webcamOverlay=document.querySelector(".js-overlay"),refreshPhotowall=document.querySelector(".js-refresh-pw"),checkCookies(),setInterval(checkCookies,2e3),loadIp(),getImages(),player=new Twitch.Player("js-stream-content",{height:"100%",width:"100%",channel:"JHkrak"}),loadCamButton.addEventListener("click",function(){webcamOverlay.classList.remove("c-cam-overlay-hide"),startWebcam()}),fireworkButton.addEventListener("click",sendFireworks),beerButton.addEventListener("click",sendBeer),cavaButton.addEventListener("click",sendCava),wineButton.addEventListener("click",sendWine),messageButton.addEventListener("click",listenToSubmit),refreshPhotowall.addEventListener("click",getImages)});